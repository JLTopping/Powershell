#Credit to Unknown Source
Function New-localCredentialFile {
    [CmdletBinding()]
    param (
	[Parameter][pscredential]$Credential = $(Get-Credential),
	[Parameter(Mandatory = $true)][ValidateNotNullOrEmpty()][string]$Path
    )

    $PreEncrypted = New-Object -TypeName System.Management.Automation.PSObject -Property @{
        "Password" = ($Credential.password | ConvertFrom-SecureString)
        "UserName" = $Credential.UserName
        }
    $Serialized = [management.automation.psserializer]::Serialize($PreEncrypted)
    $EncryptedData = $Serialized | ConvertTo-SecureString -AsPlainText -Force
    $EncryptedExport = $EncryptedData | ConvertFrom-SecureString
    $EncryptedExport | Out-File -FilePath $Path -Encoding ascii
    }