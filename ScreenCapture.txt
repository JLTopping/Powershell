Function Get-ScreenCapture{
    param(
    [parameter(mandatory=$true)]$PathToSaveTo,
    [Switch]$OfWindow        
    )

    #Pull Processes
    Add-Type -AssemblyName System.Drawing
    $JPEG = [Drawing.Imaging.ImageCodecInfo]::GetImageEncoders() | ? { $_.FormatDescription -eq "JPEG" }
    
    Sleep -Milliseconds 250

    #Simulate Key Presses
    if ($OfWindow) {[Windows.Forms.Sendkeys]::SendWait("%{PrtSc}")} 
        else {[Windows.Forms.Sendkeys]::SendWait("{PrtSc}")}

    Sleep -Milliseconds 250
    
    #Get Image From Clipboard
    $Bitmap = [Windows.Forms.Clipboard]::GetImage()    
    $EP = New-Object Drawing.Imaging.EncoderParameters  
    $EP.Param[0] = New-Object Drawing.Imaging.EncoderParameter ([System.Drawing.Imaging.Encoder]::Quality, [long]100) 
     
    $ScreenCapturePathBase = "$PathToSaveTo\ScreenCapture"

    #Make Unique Name by Adding New Number
    $Count = 0
    while (Test-Path "${screenCapturePathBase}${Count}.jpg") {$Count++}

    #Save Image
    $Bitmap.Save("${ScreenCapturePathBase}${Count}.jpg", $JPEG, $EP)
    }